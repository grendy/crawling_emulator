from kafka import KafkaProducer, KafkaConsumer
import json
import settings
a = json.dumps({u'contributors': None, u'truncated': False, u'text': u'RT @BebasAnwar: 10 Petikan Terpilih 2016 (Petikan ke-10): Anwar mengirim salam &amp; doa kepada Presiden PAS susulan rawatannya di IJN.\n#BebasA\u2026', u'is_quote_status': False, u'in_reply_to_status_id': None, u'id': 813790719601098752, u'favorite_count': 0, u'source': u'<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', u'retweeted': False, u'coordinates': None, u'entities': {u'symbols': [], u'user_mentions': [{u'id': 3160151311, u'indices': [3, 14], u'id_str': u'3160151311', u'screen_name': u'BebasAnwar', u'name': u'#BebasAnwar'}], u'hashtags': [], u'urls': []}, u'in_reply_to_screen_name': None, u'in_reply_to_user_id': None, u'retweet_count': 2, u'id_str': u'813790719601098752', u'favorited': False, u'retweeted_status': {u'contributors': None, u'truncated': True, u'text': u'10 Petikan Terpilih 2016 (Petikan ke-10): Anwar mengirim salam &amp; doa kepada Presiden PAS susulan rawatannya di IJN.\u2026 https://t.co/25DOSFHLHh', u'is_quote_status': False, u'in_reply_to_status_id': None, u'id': 813622910824771585, u'favorite_count': 11, u'source': u'<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', u'retweeted': False, u'coordinates': None, u'entities': {u'symbols': [], u'user_mentions': [], u'hashtags': [], u'urls': [{u'url': u'https://t.co/25DOSFHLHh', u'indices': [121, 144], u'expanded_url': u'https://twitter.com/i/web/status/813622910824771585', u'display_url': u'twitter.com/i/web/status/8\u2026'}]}, u'in_reply_to_screen_name': None, u'in_reply_to_user_id': None, u'retweet_count': 2, u'id_str': u'813622910824771585', u'favorited': False, u'user': {u'follow_request_sent': False, u'has_extended_profile': False, u'profile_use_background_image': True, u'default_profile_image': False, u'id': 3160151311, u'profile_background_image_url_https': u'https://abs.twimg.com/images/themes/theme1/bg.png', u'verified': False, u'translator_type': u'none', u'profile_text_color': u'333333', u'profile_image_url_https': u'https://pbs.twimg.com/profile_images/813725834447974401/fAQyiXp8_normal.jpg', u'profile_sidebar_fill_color': u'DDEEF6', u'entities': {u'url': {u'urls': [{u'url': u'https://t.co/1QOxSQAoBZ', u'indices': [0, 23], u'expanded_url': u'http://www.facebook.com/BebasAnwarMy', u'display_url': u'facebook.com/BebasAnwarMy'}]}, u'description': {u'urls': []}}, u'followers_count': 8209, u'profile_sidebar_border_color': u'C0DEED', u'id_str': u'3160151311', u'profile_background_color': u'C0DEED', u'listed_count': 15, u'is_translation_enabled': False, u'utc_offset': -28800, u'statuses_count': 2762, u'description': u'The official Twitter channel for the #FreeAnwar campaign. Saluran rasmi Twitter untuk kempen #BebasAnwar.', u'friends_count': 76, u'location': u'Sungai Buloh, Selangor', u'profile_link_color': u'1DA1F2', u'profile_image_url': u'http://pbs.twimg.com/profile_images/813725834447974401/fAQyiXp8_normal.jpg', u'following': False, u'geo_enabled': True, u'profile_banner_url': u'https://pbs.twimg.com/profile_banners/3160151311/1482501106', u'profile_background_image_url': u'http://abs.twimg.com/images/themes/theme1/bg.png', u'screen_name': u'BebasAnwar', u'lang': u'en', u'profile_background_tile': False, u'favourites_count': 34, u'name': u'#BebasAnwar', u'notifications': False, u'url': u'https://t.co/1QOxSQAoBZ', u'created_at': u'Thu Apr 16 19:15:49 +0000 2015', u'contributors_enabled': False, u'time_zone': u'Pacific Time (US & Canada)', u'protected': False, u'default_profile': True, u'is_translator': False}, u'geo': None, u'in_reply_to_user_id_str': None, u'possibly_sensitive': False, u'lang': u'in', u'created_at': u'Tue Dec 27 05:49:52 +0000 2016', u'in_reply_to_status_id_str': None, u'place': None}, u'user': {u'follow_request_sent': False, u'has_extended_profile': False, u'profile_use_background_image': False, u'default_profile_image': False, u'id': 1839871, u'profile_background_image_url_https': u'https://pbs.twimg.com/profile_background_images/850500899/44b8ad252b51524990f050879a56c297.jpeg', u'verified': True, u'translator_type': u'none', u'profile_text_color': u'000000', u'profile_image_url_https': u'https://pbs.twimg.com/profile_images/601756190285004800/mkm__FR1_normal.jpg', u'profile_sidebar_fill_color': u'E0FF92', u'entities': {u'url': {u'urls': [{u'url': u'https://t.co/gWuHousfij', u'indices': [0, 23], u'expanded_url': u'https://www.facebook.com/anwaribrahim.keadilan/', u'display_url': u'facebook.com/anwaribrahim.k\u2026'}]}, u'description': {u'urls': []}}, u'followers_count': 968684, u'profile_sidebar_border_color': u'000000', u'id_str': u'1839871', u'profile_background_color': u'000000', u'listed_count': 2381, u'is_translation_enabled': False, u'utc_offset': 28800, u'statuses_count': 52719, u'description': u'Prisoner of Conscience', u'friends_count': 14375, u'location': u'Malaysia', u'profile_link_color': u'000000', u'profile_image_url': u'http://pbs.twimg.com/profile_images/601756190285004800/mkm__FR1_normal.jpg', u'following': False, u'geo_enabled': False, u'profile_banner_url': u'https://pbs.twimg.com/profile_banners/1839871/1431791691', u'profile_background_image_url': u'http://pbs.twimg.com/profile_background_images/850500899/44b8ad252b51524990f050879a56c297.jpeg', u'screen_name': u'anwaribrahim', u'lang': u'en', u'profile_background_tile': False, u'favourites_count': 362, u'name': u'Anwar Ibrahim', u'notifications': False, u'url': u'https://t.co/gWuHousfij', u'created_at': u'Thu Mar 22 05:28:29 +0000 2007', u'contributors_enabled': False, u'time_zone': u'Kuala Lumpur', u'protected': False, u'default_profile': False, u'is_translator': False}, u'geo': None, u'in_reply_to_user_id_str': None, u'lang': u'in', u'created_at': u'Tue Dec 27 16:56:41 +0000 2016', u'in_reply_to_status_id_str': None, u'place': None})
for kafka in range(0, 20):
    try:
        producer = KafkaProducer(bootstrap_servers=settings.broker)
        producer.send(settings.kafka_topic, a)
        print "======================================="
        # print post_id
        # print json_post
        print "SELESAI KIRIM"
        break
    except:
        pass